# =============================================================================
# TIMSIM-VALIDATE Configuration Template
# =============================================================================
# This file contains all configurable settings for the timsim-validate tool.
# Copy this file and modify as needed for your validation runs.
#
# Usage:
#   timsim-validate --config /path/to/your_config.toml
#
# CLI arguments override values in this file, allowing you to use a base
# config and override specific values as needed:
#   timsim-validate --config config.toml --min-id-rate 0.5 --verbose
# =============================================================================

[paths]
# Path to reference .d folder for instrument layout
# Required if NOT using existing_simulation
reference_path = "/path/to/reference.d"

# Path to FASTA file
# Optional for new simulations (uses bundled test proteome if not specified)
# REQUIRED when using existing_simulation
# fasta_path = "/path/to/proteome.fasta"

# Output directory for validation results
output_dir = "./timsim-validate-output"

# Path to existing simulation .d folder (skips simulation step)
# If set, reference_path is not required but fasta_path IS required
# existing_simulation = "/path/to/existing/simulation.d"

# Path to synthetic_data.db (only needed if DB is not in parent of .d folder)
# By default, the database is assumed to be in the parent directory of the .d folder
# database_path = "/path/to/synthetic_data.db"

[simulation]
# Number of peptides to simulate (smaller = faster validation)
# Recommended: 5000 for quick validation, 10000+ for thorough testing
num_peptides = 5000

# Gradient length in seconds
# 900 = 15 minutes, 1800 = 30 minutes, 3600 = 60 minutes
gradient_length = 1800.0

# Acquisition type: "DIA" or "DDA"
acquisition_type = "DIA"

# Apply fragmentation to peptide ions
apply_fragmentation = true

# Processing batch size
batch_size = 256

# Number of threads (-1 = auto-detect based on CPU cores)
num_threads = -1

[diann]
# Path to DiaNN executable (or just 'diann' if in PATH)
executable_path = "diann"

# Number of threads for DiaNN analysis
threads = 4

# Timeout in seconds (3600 = 1 hour)
# Increase for larger simulations or slower systems
timeout_seconds = 3600

# Q-value threshold for filtering
qvalue = 0.01

# Run in library-free mode (enables --fasta-search, no spectral library needed)
library_free = true

# Use deep learning predictors for RT/IM
use_predictor = true

# Mass accuracy settings (in ppm)
# Leave commented to use DiaNN auto-detection
# mass_acc = 10.0
# mass_acc_ms1 = 10.0

# Peptide settings
min_pep_len = 7
max_pep_len = 30
missed_cleavages = 2
enzyme = "K*,R*"  # Trypsin (K*,R* = cut after K and R)
met_excision = true  # N-terminal methionine excision

# Fragment m/z range (optional)
# min_fr_mz = 200.0
# max_fr_mz = 1800.0

# Modifications
# Fixed modification format: "residue,modification_name"
# Example: "C,carbamidomethyl" for carbamidomethylation of cysteine
# fixed_mod = "C,carbamidomethyl"

# Variable modification format: "residue,modification_name"
# Example: "M,oxidation" for oxidation of methionine
# var_mod = "M,oxidation"

# Maximum number of variable modifications per peptide
var_mods = 2

[thresholds]
# Validation thresholds determine pass/fail criteria
# Adjust these based on your expected simulation quality

# Minimum identification rate (fraction of ground truth peptides found by DiaNN)
# 0.30 = 30% of simulated peptides should be identified
min_identification_rate = 0.30

# Minimum retention time correlation (Pearson R)
# Measures how well simulated RT matches DiaNN-predicted RT
min_rt_correlation = 0.90

# Maximum retention time mean absolute error in minutes
max_rt_mae_minutes = 1.0

# Minimum ion mobility correlation (Pearson R)
# Measures how well simulated IM matches DiaNN-predicted IM
min_im_correlation = 0.90

# Maximum ion mobility mean absolute error in 1/K0 units
max_im_mae = 0.05

# Minimum quantification correlation (Pearson R on log-transformed intensities)
# This is informational and doesn't affect pass/fail
min_quant_correlation = 0.70

[behavior]
# Keep temporary simulation files after validation completes
# Useful for debugging or manual inspection
keep_temp = false

# Verbose output (shows detailed progress)
verbose = false

# Quiet mode (minimal output, only final status)
quiet = false
