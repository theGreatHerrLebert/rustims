# =============================================================================
# TIMSIM Configuration File
# =============================================================================
# This file contains all configurable parameters for the timsim proteomics
# simulation engine. Parameters are organized into logical sections.
#
# For more information, see: https://github.com/theGreatHerrLebert/rustims
# =============================================================================

# -----------------------------------------------------------------------------
# PATHS - Required settings for input/output locations
# -----------------------------------------------------------------------------
[paths]
# Output directory for simulated data (required)
save_path = "/path/to/output"

# Reference timsTOF .d folder for acquisition parameters (required)
reference_path = "/path/to/reference.d"

# FASTA file or directory containing protein sequences (required)
fasta_path = "/path/to/proteome.fasta"

# Path to modifications config file (optional, uses default if empty)
modifications = ""

# Path to existing simulation to use as template (optional)
existing_path = ""

# -----------------------------------------------------------------------------
# EXPERIMENT - General experiment configuration
# -----------------------------------------------------------------------------
[experiment]
# Experiment name (use [PLACEHOLDER] to auto-insert acquisition type)
experiment_name = "TIMSIM-[PLACEHOLDER]"

# Acquisition type: "DIA" or "DDA"
acquisition_type = "DIA"

# LC gradient length in seconds
gradient_length = 3600.0

# Use reference dataset layout for frames/scans
use_reference_layout = true

# Load reference dataset into memory (faster but uses more RAM)
reference_in_memory = false

# Use Bruker SDK for accurate mass/mobility calibration (not available on macOS)
use_bruker_sdk = true

# Apply fragmentation to peptide ions
apply_fragmentation = true

# Continue from existing simulation
from_existing = false

# Suppress verbose output
silent_mode = false

# -----------------------------------------------------------------------------
# DIGESTION - Protein digestion and peptide sampling
# -----------------------------------------------------------------------------
[digestion]
# Number of proteins to sample from FASTA
n_proteins = 20000

# Total number of peptides to generate before sampling
num_peptides_total = 250000

# Number of peptides to sample for simulation
num_sample_peptides = 25000

# Whether to sample peptides (false = use all)
sample_peptides = true

# Random seed for reproducible sampling
sample_seed = 41

# Perform enzymatic digestion (false = use full sequences)
digest_proteins = true

# Remove peptides that map to multiple proteins
remove_degenerate_peptides = false

# Enzyme cleavage sites (e.g., "KR" for trypsin)
cleave_at = "KR"

# Residues that block cleavage (e.g., "P" for proline)
restrict = "P"

# Number of allowed missed cleavages
missed_cleavages = 2

# Minimum peptide length
min_len = 7

# Maximum peptide length
max_len = 30

# Generate decoy peptides
decoys = false

# Intensity upscale factor for protein abundance model
upscale_factor = 100000

# -----------------------------------------------------------------------------
# PREDICTION MODELS - Model selection for various predictions
# -----------------------------------------------------------------------------
# Each setting can be "" or "local" for the default PyTorch model,
# or a Koina model name for online prediction via koina.wilhelmlab.org
[models]
# Retention time prediction model
# Options: "" (local PyTorch), "Deeplc_hela_hf", "Chronologer_RT",
#          "AlphaPeptDeep_rt_generic", "Prosit_2019_irt"
rt_model = ""

# CCS / Ion mobility prediction model
# Options: "" (local PyTorch), "AlphaPeptDeep_ccs_generic", "IM2Deep"
ccs_model = ""

# Fragment intensity prediction model
# Options: "" or "local" (local PyTorch PROSPECT fine-tuned model, default),
#          "prosit" (Prosit_2023_intensity_timsTOF via Koina),
#          "alphapeptdeep" (AlphaPeptDeep_ms2_generic via Koina - supports phospho!),
#          "ms2pip" (ms2pip_timsTOF2024 via Koina)
# Note: For phosphorylated peptides, use "alphapeptdeep" as Prosit doesn't support phospho
intensity_model = ""

# -----------------------------------------------------------------------------
# RETENTION TIME - Chromatographic peak settings
# -----------------------------------------------------------------------------
[retention_time]
# Deprecated: Use [models] rt_model instead
# Kept for backwards compatibility
koina_rt_model = ""

# Minimum RT as percentage of gradient (exclude early eluting peptides)
min_rt_percent = 2.0

# Exclude peptides that elute before gradient accumulation phase
exclude_accumulated_gradient_start = true

# EMG peak shape parameters - sigma (peak width)
# If null, calculated automatically from gradient_length
sigma_lower_rt = 1.0
sigma_upper_rt = 2.5
sigma_alpha_rt = 4
sigma_beta_rt = 4

# EMG peak shape parameters - k (asymmetry/tailing)
k_lower_rt = 0
k_upper_rt = 10
k_alpha_rt = 1
k_beta_rt = 20

# Target probability mass for peak boundaries
target_p = 0.999

# Step size for EMG integration
sampling_step_size = 0.001

# Number of integration steps for EMG calculation
n_steps = 1000

# Threshold for removing low-probability frame occurrences
remove_epsilon = 1e-4

# -----------------------------------------------------------------------------
# ION MOBILITY - Ion mobility settings
# -----------------------------------------------------------------------------
[ion_mobility]
# Use mean inverse mobility standard deviation
use_inverse_mobility_std_mean = true

# Mean inverse mobility standard deviation (1/K0 units)
inverse_mobility_std_mean = 0.009

# -----------------------------------------------------------------------------
# CHARGE STATES - Ionization and charge state distribution
# -----------------------------------------------------------------------------
[charge_states]
# Probability parameter for charge state model
p_charge = 0.8

# Maximum charge state to simulate
max_charge = 4

# Minimum contribution threshold for charge states
min_charge_contrib = 0.005

# Use binomial model instead of deep learning model
binomial_charge_model = false

# Normalize charge state distribution
normalize_charge_states = true

# Probability of charge state +1 (for deep learning model)
charge_state_one_probability = 0.0

# -----------------------------------------------------------------------------
# ISOTOPIC PATTERN - Isotope distribution settings
# -----------------------------------------------------------------------------
[isotopic_pattern]
# Number of isotope peaks to simulate
isotope_k = 8

# Minimum relative intensity for isotope peaks
isotope_min_intensity = 1

# Use centroid mode for isotope peaks
isotope_centroid = true

# -----------------------------------------------------------------------------
# FRAGMENT INTENSITY - Fragment ion intensity prediction
# -----------------------------------------------------------------------------
[fragment_intensity]
# Deprecated: Use [models] intensity_model instead
# Kept for backwards compatibility
# Options: "" or "prosit" (Prosit via Koina), "alphapeptdeep" (phospho-compatible),
#          "ms2pip" (ms2pip_timsTOF2024)
fragment_intensity_model = ""

# Downsampling factor for fragment spectra (0.0-1.0)
down_sample_factor = 0.5

# -----------------------------------------------------------------------------
# NOISE - Signal noise and variation settings
# -----------------------------------------------------------------------------
[noise]
# Add noise to frame-level abundances
noise_frame_abundance = false

# Add noise to scan-level abundances
noise_scan_abundance = false

# Add m/z noise to precursor ions
mz_noise_precursor = false

# Precursor m/z noise in PPM
precursor_noise_ppm = 5.0

# Add m/z noise to fragment ions
mz_noise_fragment = false

# Fragment m/z noise in PPM
fragment_noise_ppm = 5.0

# Use uniform distribution for m/z noise (vs. Gaussian)
mz_noise_uniform = false

# Add real chemical/electronic noise from reference data
add_real_data_noise = false

# Maximum intensity for reference noise peaks
reference_noise_intensity_max = 30.0

# Sample fraction for precursor noise frames
precursor_sample_fraction = 0.2

# Sample fraction for fragment noise frames
fragment_sample_fraction = 0.2

# Number of precursor frames to sample for noise
num_precursor_noise_frames = 5

# Number of fragment frames to sample for noise
num_fragment_noise_frames = 5

# -----------------------------------------------------------------------------
# VARIATION - Apply variation to existing simulation
# -----------------------------------------------------------------------------
[variation]
# Re-scale retention times to new gradient length
re_scale_rt = false

# Standard deviation for RT variation (seconds, null = no variation)
rt_variation_std = ""

# Standard deviation for ion mobility variation (1/K0 units, null = no variation)
ion_mobility_variation_std = ""

# Standard deviation for log-intensity variation (null = no variation)
intensity_variation_std = ""

# -----------------------------------------------------------------------------
# ACQUISITION - Acquisition-specific settings
# -----------------------------------------------------------------------------
[acquisition]
# Round collision energies to integers
round_collision_energy = true

# Decimal places for collision energy (0 = integer)
collision_energy_decimals = 0

# -----------------------------------------------------------------------------
# DDA SETTINGS - DDA-PASEF specific parameters
# -----------------------------------------------------------------------------
[dda]
# Acquire precursor scan every N frames
precursors_every = 10

# Minimum intensity for precursor selection
precursor_intensity_threshold = 500

# Maximum precursors per cycle
max_precursors = 25

# Exclusion window width in frames
exclusion_width = 25

# Selection mode: "topN" or "random"
selection_mode = "topN"

# -----------------------------------------------------------------------------
# PROTEOME MIX - Multi-FASTA mixing settings
# -----------------------------------------------------------------------------
[proteome_mix]
# Enable proteome mixture mode
proteome_mix = false

# Dilution factors for multi-FASTA (JSON format or path to file)
multi_fasta_dilution = ""

# -----------------------------------------------------------------------------
# PHOSPHORYLATION - Phosphoproteomics simulation
# -----------------------------------------------------------------------------
[phosphorylation]
# Enable phosphorylation mode
phospho_mode = false

# -----------------------------------------------------------------------------
# PERFORMANCE - Computational performance settings
# -----------------------------------------------------------------------------
[performance]
# Number of threads (-1 = auto-detect)
num_threads = -1

# Batch size for processing
batch_size = 256

# Batch size for frame assembly
frame_batch_size = 500

# Use lazy loading for frame assembly (reduces memory usage)
lazy_frame_assembly = false

# Enable GPU acceleration (set to false to force CPU-only mode)
# Useful for systems with unsupported GPUs (e.g., NVIDIA Blackwell)
use_gpu = true

# GPU memory limit in GB (only applies when use_gpu = true)
gpu_memory_limit_gb = 4

# -----------------------------------------------------------------------------
# LOGGING - Logging configuration
# -----------------------------------------------------------------------------
[logging]
# Log level: "DEBUG", "INFO", "WARNING", "ERROR", "CRITICAL"
log_level = "INFO"

# Log file path (relative to save_path, empty = console only)
log_file = ""
